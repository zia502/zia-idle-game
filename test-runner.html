<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vitest Test Runner</title>
    <script type="importmap">
    {
        "imports": {
            "vitest": "https://unpkg.com/vitest@1.3.1/dist/index.mjs",
            "vi": "https://unpkg.com/vitest@1.3.1/dist/vi.mjs"
        }
    }
    </script>
</head>
<body>
    <h1>Battle Reinforcement Tests</h1>
    <div id="vitest-report"></div>

    <!-- Load Battle System Dependencies (Order Matters) -->
    <script src="src/js/core/battle-logger.js"></script>
    <script src="src/js/core/skill-loader.js"></script>
    <script src="src/js/core/buff-system.js"></script>
    <!-- Character.js might depend on others, ensure they are loaded if so -->
    <script src="src/js/core/character.js"></script>
    <script src="src/js/core/job-system.js"></script> 
    <script src="src/js/core/job-skills.js"></script>
    <!-- Battle.js is the system under test -->
    <script src="src/js/core/battle.js"></script>


    <script type="module">
        // Import test utilities and test files
        // Vitest browser runner typically handles this differently,
        // but for a simple setup, we can try to run it manually.
        // This is a simplified approach. A real Vitest setup uses its CLI.

        // Since we are not using Vitest's CLI, we need to manually set up describe, it, expect, etc.
        // This is highly simplified and not a full Vitest environment.
        // For true Vitest execution, you'd run `npx vitest` in the terminal.
        // The mocks for vi.fn() will not work without Vitest's test runner.
        // Let's assume a very basic test structure for demonstration if Vitest isn't fully set up.

        // For a proper Vitest browser setup, you'd typically use something like:
        // import { runTests } from 'vitest/browser';
        // import './test/battle-reinforcement.test.js'; // Import your test file
        // runTests({
        //   root: '/', // Your project root
        //   // other Vitest config
        // }).then(report => {
        //   document.getElementById('vitest-report').innerHTML = JSON.stringify(report, null, 2);
        // });
        // However, this requires more setup.

        // The provided test file uses vi.fn(), expect(), describe(), it().
        // These are Vitest globals. To make them work here without the full Vitest runner,
        // we'd need to include a Vitest browser bundle that exposes these.
        // The importmap helps, but the execution context is still missing.

        // Fallback: If full Vitest browser runner is too complex for this step,
        // we might need to ask the user to run tests via CLI.
        // For now, let's assume the user has a way to execute this test file with Vitest.
        // The command will be `npx vitest run test/battle-reinforcement.test.js`
        // The HTML runner is more for visual feedback if tests were written without Vitest-specifics.
        
        // The test file itself is written in Vitest syntax.
        // So, the best way to run it is via the Vitest CLI.
        console.log("Test runner HTML loaded. Please run tests using 'npx vitest run test/battle-reinforcement.test.js'");
        // To actually run in browser and see output, you'd need a more complex setup
        // or a test library designed for simple browser execution.
    </script>
</body>
</html>